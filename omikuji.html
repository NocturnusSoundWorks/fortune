<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>運試しルーレット</title>

<style>
body{
  margin:0;
  font-family: sans-serif;

  background-image: url("hakei.jpg"); /* ← 画像 */
  background-size: cover;            /* ← 画面いっぱい */
  background-position: center;       /* ← 中央 */
  background-repeat: no-repeat;      /* ← 繰り返さない */

  color:black;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  flex-direction:column;
}


/* ルーレット */
.wheel{
  width:260px;
  height:260px;
  border-radius:50%;
  border:6px solid white;
  position:relative;
  overflow:hidden;
  transition: transform 4s cubic-bezier(.17,.67,.13,.99);
}


/* 区切り（7分割） */
.slice{
  position:absolute;
  width:50%;
  height:50%;
  top:50%;
  left:50%;
  transform-origin:0% 0%;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:14px;
}

/* 針 */
.pointer{
  width:0;
  height:0;
  border-left:12px solid transparent;
  border-right:12px solid transparent;
  border-top:20px solid #ff4d6d;
  margin-bottom:10px;
}

/* ボタン */
button{
  margin:10px;
  padding:10px 20px;
  font-size:16px;
  border-radius:10px;
  border:none;
  cursor:pointer;
}
.label{
  transform-origin: 0 0;
  font-size: 14px;
  font-weight: bold;
  color: black;
  text-shadow: 0 0 4px rgba(0,0,0,.4);
  white-space: nowrap;
}
.main{
  display:flex;
  gap:40px;
  align-items:center;
}
.roulette-area{
  display:flex;
  flex-direction:column;
  align-items:center;   /* ← 横方向の中央 */
  text-align:center;    /* ← 文字も中央 */
}
  

/* 右側の表 */
.table-area{
    background: rgba(255,255,255,0.9);
  padding:15px;
  border-radius:10px;
  max-width:420px;
}

.table-area table{
  border-collapse: collapse;
  width:100%;
  font-size:14px;
}

.table-area th,
.table-area td{
  border-bottom:1px solid rgba(0,0,0,0.2);
  padding:6px;
  text-align:left;
}

.table-area th{
  width:70px;
}  
@media (max-width: 768px){
  .main{
    flex-direction: column;
    gap:20px;
    align-items:center;
  }

  .table-area{
    width:90%;
  }
}
</style>
</head>

<body>

<h1>運試し</h1>

<div class="main">
  <div class="roulette-area">
    <div class="pointer"></div>
    <div class="wheel" id="wheel"></div>

    <div>
      <button onclick="startSpin()">START</button>
      <button onclick="stopSpin()">STOP</button>
    </div>

    <h2 id="result"></h2>
  </div>
<div class="table-area">
  <table>
    <tr>
      <th>大吉</th>
      <td>最高にハッピーな流れ。自信を持って進むほど良い結果に近づきます。</td>
    </tr>
    <tr>
      <th>中吉</th>
      <td>とても良い運気。謙虚さを忘れなければさらに上向いていきます。</td>
    </tr>
    <tr>
      <th>小吉</th>
      <td>小さな幸せが積み重なる日。コツコツが嬉しい実りに変わります。</td>
    </tr>
    <tr>
      <th>吉</th>
      <td>安定した順調さがあります。欲張らず今あるものを大切に。</td>
    </tr>
    <tr>
      <th>末吉</th>
      <td>ここから運気が伸びていく途中段階。焦らず整えるのが鍵。</td>
    </tr>
    <tr>
      <th>平</th>
      <td>大きな波は立ちません。穏やかな気持ちで心地よく過ごせます。</td>
    </tr>
    <tr>
      <th>凶</th>
      <td>少し注意が必要な流れ。慎重な選択があなたを守ります。</td>
    </tr>
    <tr>
      <th>大凶</th>
      <td>停滞気味の運気。無理をせず、回復のタイミングを待ちましょう。</td>
    </tr>
  </table>
</div>

 
  
</div>

<h2 id="result"></h2>


<script>
const results = ["大吉","中吉","小吉","吉","末吉","平","凶","大凶"];

const wheel = document.getElementById("wheel");

// スライス作成
const colors = [
  "#81D8D0", // ティファニーブルー
  "#aee7e3",
  "#d4f3f1",
  "#ffffff",
  "#b8e0dd",
  "#e6f7f6",
  "#cfeeed",
  "#f3fbfb"
];


results.forEach((r,i)=>{
  const s = document.createElement("div");
  s.className = "slice";
  s.style.background = colors[i];
  s.style.transform = `rotate(${360/results.length*i}deg) skewY(${90-360/results.length}deg)`;
  s.innerHTML = `
  <div class="label"
       style="
transform:
skewY(-${90-360/results.length}deg)
rotate(${360/results.length/2}deg)
translate(18px, -5px);
">
    ${r}
  </div>
`;
  wheel.appendChild(s);
});

let spinning = false;
let currentRotation = 0;

function startSpin(){
  spinning = true;
  document.getElementById("result").textContent = "";
  spinLoop();
}

function spinLoop(){
  if(!spinning) return;
  currentRotation += 20;
  wheel.style.transform = `rotate(${currentRotation}deg)`;
  requestAnimationFrame(spinLoop);
}

function stopSpin(){
  spinning = false;

  // ===== 確率設定 =====
const weights = [6, 15, 23, 23, 23,7, 2, 1]; 
// results と同じ順番

function weightedRandom() {
  const total = weights.reduce((a,b)=>a+b,0);
  let r = Math.random() * total;

  for (let i = 0; i < weights.length; i++) {
    if (r < weights[i]) return i;
    r -= weights[i];
  }
  return 0;
}

const finalIndex = weightedRandom();


  const degPerSlice = 360/results.length;

  const stopAngle = (360*5) + (360 - finalIndex*degPerSlice - degPerSlice/2);

  wheel.style.transform = `rotate(${stopAngle}deg)`;

  setTimeout(()=>{
    document.getElementById("result").textContent = results[finalIndex];
  },4000);
}
</script>

</body>
</html>
